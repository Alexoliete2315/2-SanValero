CREATE OR REPLACE PROCEDURE EJERCICIO7 AS
    V_INC NUMBER(6,2);
    V_SAL_MEDIO NUMBER(6,2);
BEGIN
    FOR V_REG IN (SELECT ROWID, EMP_NO, SALARIO, OFICIO FROM EMPLE E WHERE SALARIO < (SELECT AVG(SALARIO) FROM EMPLE WHERE OFICIO=E.OFICIO)) LOOP
        SELECT AVG(SALARIO) INTO V_SAL_MEDIO FROM EMPLE WHERE OFICIO = V_REG.OFICIO;
        UPDATE EMPLE SET SALARIO = SALARIO + (V_SAL_MEDIO - SALARIO) / 2 WHERE ROWID = V_REG.ROWID;
    END LOOP;

    COMMIT;
EXCEPTION
    WHEN OTHERS THEN 
        DBMS_OUTPUT.PUT_LINE('ERROR');
END EJERCICIO7;
/
